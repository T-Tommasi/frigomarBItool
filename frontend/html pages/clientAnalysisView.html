<div class="analytics-container">

  <div class="content-card" id="client-master-list"> <div class="content-card-header">
      <div style="display: flex; align-items: center; justify-content: space-between;">
        <div>
          <h3>Analisi Margini Cliente</h3>
          <p>Riepilogo generale dei clienti e relativi margini.</p>
        </div>
        <button class="reusable-btn" id="report-modal-btn" type="button">Genera Report</button>
      </div>
<div class="search-bar-container">
  <input type="text" id="client-analytics-search-input" class="search-input" placeholder="Cerca cliente...">
</div>
<!-- Modale report -->
<div class="modal-overlay" id="report-modal-overlay" style="display:none;">
  <div class="modal-content">
    <h2>Seleziona tipo di report</h2>
    <form id="report-type-form">
      <fieldset>
        <legend>Formato</legend>
        <label class="disabled"><input type="radio" name="reportFormat" value="PDF" disabled> PDF</label>
        <label class="disabled"><input type="radio" name="reportFormat" value="DOCS" disabled> DOCS</label>
        <label class="disabled"><input type="radio" name="reportFormat" value="CSV" disabled> CSV</label>
        <label><input type="radio" name="reportFormat" value="SHEET" checked> SHEET</label>
      </fieldset>
      <fieldset>
        <legend>Opzioni</legend>
        <label><input type="checkbox" name="anomalyTracking"> Anomaly tracking</label>
        <label><input type="checkbox" name="detailedReport"> Detailed report</label>
      </fieldset>
      <div class="modal-actions">
        <button type="button" id="close-modal-btn" class="reusable-btn">Chiudi</button>
        <button type="submit" class="reusable-btn">Genera</button>
      </div>
    </form>
  </div>
</div>
<script>
  // Modal logic
  document.addEventListener('DOMContentLoaded', function() {
    var reportBtn = document.getElementById('report-modal-btn');
    var modalOverlay = document.getElementById('report-modal-overlay');
    var closeModalBtn = document.getElementById('close-modal-btn');
    if (reportBtn && modalOverlay && closeModalBtn) {
      reportBtn.addEventListener('click', function() {
        modalOverlay.style.display = 'flex';
      });
      closeModalBtn.addEventListener('click', function() {
        modalOverlay.style.display = 'none';
      });
      modalOverlay.addEventListener('click', function(e) {
        if (e.target === modalOverlay) {
          modalOverlay.style.display = 'none';
        }
      });
    }
  });
</script>
    </div>
    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th class="sortable" data-sort-key="uuid">UUID</th>
            <th class="sortable" data-sort-key="name">Nominativo Cliente</th>
            <th class="sortable text-center" data-sort-key="productsCount">Prodotti Acq.</th>
            <th class="sortable text-center" data-sort-key="totalRevenue">Costo / Ricavo Totale</th>
            <th class="sortable text-right" data-sort-key="totalMargin">Margine Totale</th>
            <th class="sortable text-center" data-sort-key="marginPercentage">Margine %</th>
            <th class="text-center"></th> </tr>
        </thead>
        <tbody id="client-analytics-master-body">
          <tr>
            <td colspan="7" class="text-center" style="padding: 3rem;">Caricamento dati in corso...</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="content-card" id="client-detail-view"> <div class="content-card-header">
      <h3>Dettagli Prodotto per Cliente</h3>
      <p>Seleziona un cliente dalla tabella a sinistra per visualizzare i dettagli.</p>
    </div>
    <div class="table-container" id="client-analytics-detail-body">
    </div>
  </div>

</div>